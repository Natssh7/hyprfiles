(()=>{"use strict";var e,i,t,a={4500:(e,i,t)=>{var a=t(341),s=t(729),n=t(9956),o=t(6229),r=t(2502);const g={class:"preview-images"},l=["data-index"],m={class:"image-container"},c=["srcset"],d=["src","data-index","alt"],h={key:0,class:"image-details"},u={class:"image-dimension-icon-container"},p=(0,o._)("div",{class:"image-data-separator"},"•",-1),w={key:0,class:"image-data-separator"};var v=t(2343),f=t(2758),I=t(2667),b=t(3145);const y={components:{[f.gV.name]:f.gV,[f.zx.name]:f.zx,[f.Zb.name]:f.Zb,[f.T$.name]:f.T$,[f.SK.name]:f.SK,[f.ll.name]:f.ll,[f.Vq.name]:f.Vq,[f.iz.name]:f.iz,[f.JO.name]:f.JO},data:function(){return{showDialog:!1,hasScrollBar:!1,previewImages:[],imagesLoaded:!1,largestImageWidth:0,largestImageHeight:0,largestImageDimension:0,largestImageIndex:null,minWidthViewport:!1,theme:""}},computed:{separatorClasses:function(){return{visible:this.hasScrollBar}}},rawData:{session:null},methods:{getText:I.Q,processMessage:async function(e,i){"openView"===e.id?(this.setup(e.session,e.images),this.openDialog()):"closeView"===e.id&&this.closeDialog()},onMessage:function(e,i){(0,s.x9)({request:e,sender:i,requestHandler:this.processMessage})},onCancel:function(){this.closeDialog(),b.runtime.sendMessage({id:"cancelView",view:"confirm"})},onSelection:async function(e){this.closeDialog();const i=this.previewImages[e.currentTarget.dataset.index].image;"share"===this.$options.rawData.session.sessionType?(await(0,s.Gy)(i,{convert:this.$options.rawData.session.options.convertSharedImage}),b.runtime.sendMessage({id:"cancelView",view:"confirm"})):await(0,s.MX)({message:{id:"imageConfirmationSubmit",image:i,session:this.$options.rawData.session},openConnection:this.$env.isSafari})},onPreviewImageLoad:function(e){this.setPreviewImageLoaded(e.target.dataset.index)},onPreviewImageError:function(e){const i=e.target.previousElementSibling;i.srcset=e.target.src,i.type="image/svg+xml",this.setPreviewImageLoaded(e.target.dataset.index)},setPreviewImageLoaded:function(e){this.previewImages[e].imageLoaded=!0,this.setImagesLoaded()},setImagesLoaded:function(){this.previewImages.every((e=>e.imageLoaded))&&!this.imagesLoaded&&(this.setImageDetails(),this.focusPreviewImage(),this.imagesLoaded=!0)},setImageDetails:function(){for(const e of document.querySelectorAll(".preview-images .image")){const i=e.dataset.index,t=this.previewImages[i];(0,s.bD)(e)&&(t.imageWidth=e.naturalWidth,t.imageHeight=e.naturalHeight,t.imageDimension=t.imageWidth*t.imageHeight,t.imageDimension>this.largestImageDimension&&(this.largestImageDimension=t.imageDimension,this.largestImageIndex=i),t.imageWidth>this.largestImageWidth&&(this.largestImageWidth=t.imageWidth),t.imageHeight>this.largestImageHeight&&(this.largestImageHeight=t.imageHeight)),t.imageDetails=(0,s.pb)({width:t.imageWidth,height:t.imageHeight,size:t.image.imageSize,type:t.image.imageType,iecSize:!this.$env.isWindows})}},filterImageDetails:function(e){return e.filter((e=>!("size"===e.kind&&!this.minWidthViewport)))},addPreviewImages:function(e){this.previewImages=e.map((e=>({image:(0,v.Xl)(e),imageWidth:0,imageHeight:0,imageDimension:0,imageLoaded:!1,imageDetails:[]})))},focusPreviewImage:function(){const e=document.querySelector(null!==this.largestImageIndex?`.tile-container[data-index="${this.largestImageIndex}"]`:".tile-container");window.setTimeout((()=>e.focus()),300)},openDialog:function(){this.showDialog=!0},closeDialog:function(){this.showDialog=!1},initResizeObservers:function(){const e=window.matchMedia("(min-width: 400px)");e.addEventListener("change",this.setMinWidthViewport),this.setMinWidthViewport(e);const i=new ResizeObserver(this.configureScrollBar),t=document.querySelector(".preview-images");i.observe(t),i.observe(t.parentNode),this.configureScrollBar()},setMinWidthViewport:function(e){this.minWidthViewport=e.matches},configureScrollBar:function(){const e=document.querySelector(".preview-images").parentNode;this.hasScrollBar=e.scrollHeight>e.clientHeight},setup:function(e,i){this.previewImages=[],this.imagesLoaded=!1,this.largestImageWidth=0,this.largestImageHeight=0,this.largestImageDimension=0,this.largestImageIndex=null,this.$options.rawData.session=e,this.$nextTick((()=>{this.addPreviewImages(i)}))},init:async function(){if(this.$env.isFirefox)b.runtime.onMessage.addListener(this.onMessage),b.runtime.sendMessage({id:"routeMessage",setSenderFrameId:!0,messageFrameId:0,message:{id:"saveFrameId"}});else{const e=await b.tabs.getCurrent();this.contentMessagePort=b.tabs.connect(e.id,{name:"view",frameId:0}),this.contentMessagePort.onMessage.addListener(this.onMessage)}this.theme=await(0,s.Z8)(),document.addEventListener("themeChange",(e=>{this.theme=e.detail})),window.addEventListener("keydown",(e=>{"Escape"===e.key&&(e.preventDefault(),e.stopImmediatePropagation(),this.onCancel())}),{capture:!0,passive:!1}),this.initResizeObservers()}},mounted:function(){this.init()}},D=(0,t(6021).Z)(y,[["render",function(e,i,t,s,n,v){const f=(0,o.up)("vn-card-title"),I=(0,o.up)("vn-divider"),b=(0,o.up)("vn-icon"),y=(0,o.up)("vn-card-text"),D=(0,o.up)("vn-button"),k=(0,o.up)("vn-card-actions"),x=(0,o.up)("vn-card"),_=(0,o.up)("vn-dialog"),S=(0,o.up)("vn-app");return(0,o.wg)(),(0,o.j4)(S,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,{modelValue:e.showDialog,"onUpdate:modelValue":i[4]||(i[4]=i=>e.showDialog=i),"content-class":"confirmation-dialog__content",transition:"scale-transition",scrollable:"",persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.toDisplayString)(v.getText("dialogTitle_imageConfirmation")),1)])),_:1}),(0,o.Uk)(),(0,o.Wm)(I,{class:(0,r.normalizeClass)(v.separatorClasses)},null,8,["class"]),(0,o.Uk)(),(0,o.Wm)(y,{tabindex:"-1"},{default:(0,o.w5)((()=>[(0,o._)("div",g,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.previewImages,((t,s)=>((0,o.wg)(),(0,o.iD)("div",{class:"tile-container",tabindex:"0","data-index":s,onClick:i[2]||(i[2]=(...e)=>v.onSelection&&v.onSelection(...e)),onKeyup:i[3]||(i[3]=(0,a.withKeys)(((...e)=>v.onSelection&&v.onSelection(...e)),["enter"])),key:s},[(0,o._)("picture",m,[(0,o._)("source",{srcset:t.image.imageDataUrl||t.image.imageUrl},null,8,c),(0,o.Uk)(),(0,o._)("img",{class:"image",src:`/src/assets/icons/misc/${"dark"===e.theme?"broken-image-dark":"broken-image"}.svg`,"data-index":s,onErrorOnce:i[0]||(i[0]=(...e)=>v.onPreviewImageError&&v.onPreviewImageError(...e)),onLoad:i[1]||(i[1]=(...e)=>v.onPreviewImageLoad&&v.onPreviewImageLoad(...e)),alt:t.image.imageFilename},null,40,d)]),(0,o.Uk)(),e.imagesLoaded?((0,o.wg)(),(0,o.iD)("div",h,[!e.largestImageDimension||t.imageWidth!==e.largestImageWidth&&t.imageHeight!==e.largestImageHeight&&t.imageDimension!==e.largestImageDimension?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("div",u,[t.imageWidth===e.largestImageWidth&&t.imageHeight<e.largestImageHeight?((0,o.wg)(),(0,o.j4)(b,{key:0,class:"image-dimension-icon",src:"/src/assets/icons/misc/swap-horiz.svg",title:v.getText("pageContent_widest_image")},null,8,["title"])):(0,o.kq)("",!0),(0,o.Uk)(),t.imageHeight===e.largestImageHeight&&t.imageWidth<e.largestImageWidth?((0,o.wg)(),(0,o.j4)(b,{key:1,class:"image-dimension-icon",src:"/src/assets/icons/misc/swap-vert.svg",title:v.getText("pageContent_tallest_image")},null,8,["title"])):(0,o.kq)("",!0),(0,o.Uk)(),t.imageDimension===e.largestImageDimension?((0,o.wg)(),(0,o.j4)(b,{key:2,class:"image-dimension-icon",src:"/src/assets/icons/misc/open-with.svg",title:v.getText("pageContent_largest_image")},null,8,["title"])):(0,o.kq)("",!0)]),(0,o.Uk)(),p],64)),(0,o.Uk)(),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(v.filterImageDetails(t.imageDetails),((e,i)=>((0,o.wg)(),(0,o.iD)(o.HY,{key:i},[i?((0,o.wg)(),(0,o.iD)("div",w,"•")):(0,o.kq)("",!0),(0,o.Uk)(),(0,o._)("div",{class:(0,r.normalizeClass)({[`image-${e.kind}-text`]:!0})},(0,r.toDisplayString)(e.text),3)],64)))),128))])):(0,o.kq)("",!0)],40,l)))),128))])])),_:1}),(0,o.Uk)(),(0,o.Wm)(I,{class:(0,r.normalizeClass)(v.separatorClasses)},null,8,["class"]),(0,o.Uk)(),(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[(0,o.Wm)(D,{onClick:v.onCancel,variant:"tonal"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.toDisplayString)(v.getText("buttonLabel_cancel")),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}]]);!async function(){await(0,s.hR)(["400 14px Roboto","500 14px Roboto"]);const e=(0,a.createApp)(D);await(0,s.cO)(e),await(0,n.y)(e),e.mount("body")}()}},s={};function n(e){var i=s[e];if(void 0!==i)return i.exports;var t=s[e]={exports:{}};return a[e].call(t.exports,t,t.exports,n),t.exports}n.m=a,e=[],n.O=(i,t,a,s)=>{if(!t){var o=1/0;for(m=0;m<e.length;m++){for(var[t,a,s]=e[m],r=!0,g=0;g<t.length;g++)(!1&s||o>=s)&&Object.keys(n.O).every((e=>n.O[e](t[g])))?t.splice(g--,1):(r=!1,s<o&&(o=s));if(r){e.splice(m--,1);var l=a();void 0!==l&&(i=l)}}return i}s=s||0;for(var m=e.length;m>0&&e[m-1][2]>s;m--)e[m]=e[m-1];e[m]=[t,a,s]},n.n=e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return n.d(i,{a:i}),i},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var s=Object.create(null);n.r(s);var o={};i=i||[null,t({}),t([]),t(t)];for(var r=2&a&&e;"object"==typeof r&&!~i.indexOf(r);r=t(r))Object.getOwnPropertyNames(r).forEach((i=>o[i]=()=>e[i]));return o.default=()=>e,n.d(s,o),s},n.d=(e,i)=>{for(var t in i)n.o(i,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:i[t]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.j=3368,(()=>{var e={3368:0};n.O.j=i=>0===e[i];var i=(i,t)=>{var a,s,[o,r,g]=t,l=0;if(o.some((i=>0!==e[i]))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(g)var m=g(n)}for(i&&i(t);l<o.length;l++)s=o[l],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(m)},t=globalThis.webpackChunksearch_by_image=globalThis.webpackChunksearch_by_image||[];t.forEach(i.bind(null,0)),t.push=i.bind(null,t.push.bind(t))})();var o=n.O(void 0,[2787],(()=>n(4500)));o=n.O(o)})();